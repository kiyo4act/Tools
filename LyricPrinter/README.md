# 歌詞ページ印刷用整形ツール

このツールは、歌詞ページのHTMLソースを指定された形式に整形し、印刷に適したレイアウトで表示・出力するためのクライアントサイドウェブアプリケーションです。

**ツールURL:** [https://kiyo.bio/Tools/LyricPrinter/](https://kiyo.bio/Tools/LyricPrinter/)

## 1. ユーザー向け説明

このツールは、主に `utaten.com` から取得した歌詞ページのHTML情報を元に、印刷しやすいように整形する目的で作成されました。
ウェブページから直接印刷すると不要な要素が多く含まれたり、レイアウトが崩れたりすることがありますが、このツールを使用することで、歌詞と主要な曲情報のみをスッキリとしたフォーマットで印刷またはHTMLファイルとして保存できます。

詳しい使い方は、ツールページ内の「使い方」セクションをご参照ください。

## 2. 開発者 (オーナー) のための備忘録

### 2.1. ツールの目的と構成

このツールは、特定のウェブサイト（現在は `utaten.com`）の歌詞ページから取得したHTMLを、印刷に適した形式に整形するためのものです。技術的には、HTML、CSS、JavaScriptのみで構成された完全にクライアントサイドで動作するアプリケーションであり、GitHub Pages ([https://kiyo.bio/Tools/LyricPrinter/](https://kiyo.bio/Tools/LyricPrinter/)) 上でホスティングされています。

ユーザーが不要な情報を取り除き、フォントサイズや改行、改ページなどを調整して、見やすい形で歌詞を印刷またはHTMLファイルとして保存できるようにすることを目的としています。

### 2.2. AIへメンテナンスを指示する際の手順とポイント

このツールをAI（あなたのような生成AI）にメンテナンスさせる場合、以下の手順と情報提供を心がけると、スムーズに更新が進められます。

1.  **情報共有 (AIへの初期プロンプト例):**
    * メンテナンス作業を開始する際に、まず以下の情報をAIに提供してください。
        ```
        これから、私が管理しているウェブツール「歌詞ページ印刷用整形ツール」のメンテナンスをお願いします。
        このツールはクライアントサイドのみで動作するHTML、CSS、JavaScriptで構成された静的サイトです。
        ホスティングはGitHub Pagesで行っており、現在のアクセスURLは [[https://kiyo.bio/Tools/LyricPrinter/](https://kiyo.bio/Tools/LyricPrinter/)] です。

        メンテナンスに必要な情報は以下の通りです。
        1. このREADME.mdファイルの内容（特に「3. このツールのメンテナンスを行うAIへの指示書」セクションを熟読してください）。
        2. 最新のソースコード3点（index.html, style.css, script.js）。（これらを添付またはコピー＆ペーストで提供します）

        上記情報を元に、これから私が行う修正や機能追加の要望に対応してください。
        成果物は、変更後の index.html, style.css, script.js の完全なソースコードとして提案してください。
        また、変更後は必ずバージョン情報と更新履歴（index.html内およびこのREADME.md内）の更新も行うように、私から指示があった場合は対応してください。
        ```
2.  **要望の明確化と指示:**
    * **何をしたいか:** 具体的な修正点（例: 「ここの表示がおかしいので直してほしい」）、追加したい機能（例: 「こういう操作ができるようにしたい」）、デザインの変更点などを明確に伝えてください。AIは、それがHTML、CSS、JavaScriptのどこをどのように変更すれば実現できるかを判断し、提案します。
    * **なぜそうしたいか:** 可能であれば、変更を加えたい背景や目的も伝えると、AIがより適切な提案をしやすくなります。
    * GA4でトラッキングしたい新しい操作があれば、その旨も伝えてください。
3.  **AIからの提案受領とテスト:**
    * AIは、指示に基づいて変更後の `index.html`, `style.css`, `script.js` の全コードを提案します。
    * 提案されたコードをあなたのローカル環境でファイルに上書き保存し、ブラウザで `index.html` を開いて、全ての機能が意図通りに動作するか十分にテストしてください。既存機能への影響（デグレなど）がないかも確認することが重要です。
4.  **バージョン情報と更新履歴の更新指示:**
    * テストで問題がなければ、AIに対して**「バージョン情報と更新履歴を更新してください」**と指示します。AIは、このREADMEの「3.2. メンテナンスを依頼された場合の基本的な進め方」の「4. バージョン情報と更新履歴の更新 (重要)」に従い、必要な箇所を適切に更新した最終的なコードセットを提案します。
5.  **デプロイ:**
    * 最終的なコードセットをGitHubリポジトリにコミット＆プッシュすることで、GitHub Pagesに自動的にデプロイされ、公開されます。

### 2.3. 重要な前提と注意点 (オーナー自身も再確認用)

* **クライアントサイド動作:** 全ての処理はユーザーのブラウザ内で完結します。
* **HTML構造依存:** 歌詞情報の抽出は `utaten.com` の特定のHTML構造に依存しています。対象サイトの構造が変更された場合、`script.js` 内のDOMセレクタの修正が必要です。
* **CORSプロキシ依存:** URLからのHTML読み込みはCORSプロキシを経由します。プロキシサービスが利用不可になった場合は、`script.js` 内の `proxies` 配列を更新する必要があります。
* **GA4測定ID:** `index.html` にGA4測定ID (`G-WWQTE7VWKG`) が設定されています。

## 3. このツールのメンテナンスを行うAIへの指示書

### 3.1. はじめに・ツールの背景とあなたの役割

こんにちは。あなたはこの「歌詞ページ印刷用整形ツール」のメンテナンスを担当するAIです。このツールは、個人ユーザー（以下「オーナー」）が特定のウェブサイト（主に `utaten.com`）から歌詞情報を取得し、印刷しやすいように整形するために開発されました。開発経緯は、オーナーと以前のAI（私のような生成AI）との対話形式によるものです。

あなたの役割は、オーナーからの修正や機能追加の要望に基づき、このツールのソースコード (`index.html`, `style.css`, `script.js`) を適切に変更し、提案することです。オーナーはプログラミングの詳細には関与せず、あなたに具体的な実装を委ねます。

ツールは完全にクライアントサイドで動作する静的サイトとして、GitHub Pages ([https://kiyo.bio/Tools/LyricPrinter/](https://kiyo.bio/Tools/LyricPrinter/)) 上でホスティングされています。

### 3.2. メンテナンスを依頼された場合の基本的な進め方

1.  **オーナーからの指示の正確な把握:**
    * 修正内容、追加機能、UIの変更点など、オーナーの要望を正確に理解してください。不明な点は必ず質問し、仕様を明確にしてください。
    * オーナーから提供される最新のソースコード (`index.html`, `style.css`, `script.js`) と、このREADME.mdの内容を基に作業を行ってください。
2.  **影響範囲の特定と設計:**
    * 要望がツールのどの部分（HTML構造、CSSスタイル、JavaScriptロジック）に影響するかを特定してください。
    * 既存のコード構造や設計思想（例: Vanilla JSでの実装、状態管理の方法など）を尊重し、一貫性を保つように変更を設計してください。
3.  **コードの生成と提案:**
    * 変更が必要なファイルの**完全なソースコード**を提案してください。オーナーはこれをコピー＆ペーストして使用します。
4.  **バージョン情報と更新履歴の更新 (重要):**
    * オーナーから「バージョン情報と更新履歴を更新してください」という明確な指示があった場合に限り、以下の箇所を更新してください。
        * **`index.html` 内:**
            * `<p class="version-info">` タグ内の表示テキスト: 総リビジョン番号を現在の番号から1増やし、最終更新日を現在の日付（YYYY年MM月DD日形式）に更新してください。例: `最終更新: 2025年5月26日 (Rev. 14)`
            * `<meta name="version" content="N">`: 総リビジョン番号N（数字のみ）に更新してください。
            * `<meta name="last-updated" content="YYYY-MM-DD">`: 最終更新日をISO形式（例: `2025-05-26`）で更新してください。
            * `<div id="updateHistoryContentEl">`内の更新履歴リスト (`<ul>`): 今回の変更内容をリストアイテム(`<li>`)として、日付とリビジョン番号と共に**先頭に**追記してください。既存のフォーマット（日付、リビジョン番号、変更点リスト）に合わせてください。
        * **`README.md` (このファイル) 内:**
            * 「更新履歴」セクションに、今回の変更内容を、日付とリビジョン番号と共に**先頭に**追記してください。`index.html` に追記した内容と整合性を取ってください。
            * このREADME.md内の他のセクション（例: 「3.3. プロジェクト構造と主要ファイル」など）で、今回の変更によって内容が古くなった箇所があれば、その修正も提案してください。
5.  **GA4イベントの考慮:**
    * 新しいユーザー操作が追加されたり、既存の重要な操作フローが変更されたりした場合は、関連するGA4イベントを `script.js` 内に追加・修正することを検討し、オーナーに提案してください。イベント名はわかりやすく、カテゴリーやラベルも適切に設定してください。

### 3.3. プロジェクト構造と主要ファイル

* `index.html`: メインページ。UI要素、静的テキスト（タイトル、説明、バージョン情報、**更新履歴本文**など）を含みます。**更新履歴のマスターデータはこのファイル内にあります。**
* `style.css`: 全てのスタイル定義。
* `script.js`: 全てのクライアントサイドロジック（DOM操作、イベント処理、HTML解析・生成、状態管理、履歴管理、GA4イベント送信など）。

### 3.4. 過去の経緯の理解

このツールは段階的に機能が追加・修正されてきました。**詳細な変更履歴は `index.html` ファイル内の「ツールの更新履歴」セクションに記載されています。** 新しい変更を加える際には、この履歴を参照し、既存機能との整合性や過去の設計判断を考慮することで、より適切なメンテナンスが可能になります。このREADME.mdの「更新履歴」セクションも、`index.html` の内容と同期している必要があります（同期はあなたのタスクです）。

### 3.5. 将来的なワークフロー自動化の可能性について – あなたへの期待

現在、オーナーはあなた（AI）が生成したコードを手動でローカルファイルに反映し、テストした後、GitHubにアップロードしています。
将来的には、あなたがより高度な開発支援を行えるようになることが期待されています。例えば、以下のような提案や支援が可能であれば、オーナーの作業負担を軽減できる可能性があります。

* **GitHub連携の提案:** あなたがGitHub APIを安全に利用できる場合、変更提案をプルリクエストとして自動作成する、あるいはオーナーが許可した場合に直接コミットするなどのワークフローを提案できるかもしれません。
* **CORSプロキシの監視と代替提案:** 現在使用しているCORSプロキシサービス (`proxies` 配列で定義) が利用できなくなった場合、それを検知し、代替の公開プロキシサービスを調査・提案する。可能であれば、その切り替え作業自体も支援する。
* **対象サイトの構造変更への対応提案:** `utaten.com` のHTML構造が変更され、情報抽出に失敗するようになった場合、その変更箇所を特定し、`script.js` 内のセレクタやパースロジックの修正案を具体的に提示する。
* **依存関係の更新提案 (もしあれば):** 将来的に外部ライブラリを導入した場合、そのライブラリのバージョンアップやセキュリティ脆弱性に関する情報をオーナーに伝え、更新を提案する。
* **テストの自動化提案:** 簡単なユニットテストやE2Eテストの雛形を提案し、ツールの安定性向上に寄与する。

これらの提案は、あなたの能力と利用可能なツールセットに依存します。現時点では、正確なコード変更と、指示されたドキュメント更新（バージョン情報、更新履歴）を確実に行うことが最も重要です。しかし、将来的に上記のような支援が可能になれば、ぜひオーナーに提案してみてください。
